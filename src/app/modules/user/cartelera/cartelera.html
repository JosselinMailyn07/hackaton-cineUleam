<app-header></app-header>

<div class="w-full p-6" style="min-height: 80vh;">

  @if (cargando) {
    <app-loader [visible]="true"></app-loader>
  }

  @if (!cargando) {

    <div class="mb-12 text-center">
      <h1 class="text-4xl font-bold text-[var(--color-primario)] mb-2">
        Cartelera de Películas
      </h1>
      <div class="w-16 h-1 mx-auto rounded-full bg-[var(--color-primario)]"></div>
    </div>

    <!-- EN CARTELERA -->
    <div class="mb-10">
      <h2 class="text-2xl font-semibold text-gray-700 mb-4">En Cartelera</h2>
      <p-carousel [value]="peliculasEnCartelera" [numVisible]="3" [numScroll]="1"
                  [responsiveOptions]="opcionesResponsivas" [showIndicators]="false">
        <ng-template pTemplate="item" let-pelicula>
          <div class="tarjeta-pelicula">
            <div class="relative">
              <img [src]="pelicula.imagen" class="imagen-pelicula" />
              <span class="etiqueta-pelicula">{{ pelicula.estado | uppercase }}</span>
            </div>
            <div class="info-pelicula">
              <span class="categoria-pelicula">{{ pelicula.categoriaNombre }}</span>
              <h3 class="titulo-pelicula">{{ pelicula.nombre }}</h3>
              <p class="descripcion-pelicula">{{ pelicula.descripcion }}</p>

              <div class="flex gap-2 mt-3">
                <button pButton label="Ver detalles" class="p-button-primary" (click)="verDetalle(pelicula)"></button>
                <button pButton label="Reservar" icon="pi pi-ticket" class="p-button-success"
                        (click)="abrirHorarios(pelicula)"></button>
              </div>
            </div>
          </div>
        </ng-template>
      </p-carousel>
    </div>

    <!-- PRÓXIMOS ESTRENOS -->
    <div>
      <h2 class="text-2xl font-semibold text-gray-700 mb-4">Próximos Estrenos</h2>
      <p-carousel [value]="peliculasProximas" [numVisible]="3" [numScroll]="1"
                  [responsiveOptions]="opcionesResponsivas" [showIndicators]="false">
        <ng-template pTemplate="item" let-pelicula>
          <div class="tarjeta-pelicula">
            <div class="relative">
              <img [src]="pelicula.imagen" class="imagen-pelicula" />
              <span class="etiqueta-pelicula">{{ pelicula.estado | uppercase }}</span>
            </div>
            <div class="info-pelicula">
              <span class="categoria-pelicula">{{ pelicula.categoriaNombre }}</span>
              <h3 class="titulo-pelicula">{{ pelicula.nombre }}</h3>
              <p class="descripcion-pelicula">{{ pelicula.descripcion }}</p>
              <div class="flex gap-2 mt-3">
                <button pButton label="Ver detalles" (click)="verDetalle(pelicula)" class="p-button-primary"></button>
                <button pButton label="Reservar" icon="pi pi-ticket" class="p-button-success"
                        (click)="abrirHorarios(pelicula)"></button>
              </div>
            </div>
          </div>
        </ng-template>
      </p-carousel>
    </div>
    <!-- Carrusel 3: Estrenos -->
<div class="mb-10">
  <h2 class="text-2xl font-semibold text-gray-700 dark:text-black-300 mb-4">Estrenos</h2>
  <p-carousel
    [value]="peliculasEstrenos"
    [numVisible]="3"
    [numScroll]="1"
    [responsiveOptions]="opcionesResponsivas"
    circular="true"
    [showIndicators]="false"
  >
    <ng-template pTemplate="item" let-pelicula>
      <!-- Reutiliza el mismo template que los otros carruseles -->
      <div class="tarjeta-pelicula">
        <div class="relative">
          <img [src]="pelicula.imagen" [alt]="pelicula.nombre" class="imagen-pelicula" />
          <span class="etiqueta-pelicula">{{ pelicula.estado | uppercase }}</span>
        </div>

        <div class="info-pelicula">
          <span *ngIf="pelicula.clasificacion" class="categoria-pelicula">{{ pelicula.clasificacion }}</span>
          <h3 class="titulo-pelicula">{{ pelicula.nombre }}</h3>
          <p class="descripcion-pelicula">{{ pelicula.descripcion }}</p>
          <button pButton
                  label="Ver detalles"
                  (click)="verDetalle(pelicula)"
                  class="p-button-primary w-auto">
          </button>
        </div>
      </div>
    </ng-template>
  </p-carousel>
</div>


  }
</div>

<!-- ✅ Modal de horarios -->
<app-horario-pelicula
  [(visible)]="mostrarModalHorarios"
  [peliculaSeleccionada]="peliculaSeleccionada">
</app-horario-pelicula>

<app-footer></app-footer>
